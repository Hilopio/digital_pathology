# digital_pathology 
transfer learning CNN based on imagenet for medical image classification 

# Содержание:
- for_test.ipynb
  основной ноутбук с решением, для проверки - просто запустить, будет импортирована лучшая модель и проверена на датасете test
  или заменить флаг EVALUATE_ONLY на False и обучить и протестировать модель на наборах train_tiny и test_tiny, обучение с T4 GPU займет пару минут
  при этом новая обученная модель не сохранится
- transfer_learning_with_plot.ipynb
  почти тот же ноутбук но с графиком accuracy в процессе обучения (потому что в пдф графики плохо сохранились)
- Nikolaev_Gleb.pdf
- README.md
  описание

# Описание:
модель получена из сверточной нейронной сети imagenet, путем заморозки весов, избавления от верхних классифицирующих слоев
и добавления нескольких своих слоев наверх, были добавленны слои:
- GlobalAveragePooling2D
- BatchNormalization
- Dropout(0.2)
- Полносвязный слой
После чего модель обучена на датасете train.npz с использованием ускорителя T4 GPU
Модель сохранена на диске в директории /content/drive/MyDrive/best.keras и может быть оттуда загружена 

# Детали
Ноутбук должен запуститься без дополнительных действий, но на случай непредвиденных обстоятельств
можно поместить файлы с данными в /content/drive/MyDrive/ и попробовать запустить так
Warnings в ноутбуках из-за того что в части тестового набора нет элементов больших классов, но модель может их ошибочно предсказывать

# Итог
Точность(Accuracy) достигает 91-92%

# Дополнительно реализованно
- аугментация данных:     #LBL1
    - RandomFlip('horizontal')
    - RandomRotation(0.2)
    - можно было добавить и другие виды аугментации, для изображений без четкой ориентированности верха и низа вполне подходят вращения и отражения
    - с яркостью решил не эксперементировать, потому что видимо все фотографии сделаны специальным оборудованием в одном освещении
- вычисление Loss и Accuracy на каждой эпохе обучения для тестовой и валидационной выборок #LBL2 (то ли это два разных пункта №5 и №7, то ли один)
- график Accuracy от номера эпохи обучения для тестовой и валидационной выборок #LBL3
